<!-- Database Page -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Main meta tags -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Page title displayed in the browser tab -->
    <title>CDA Project - Database</title>
    <!-- Main stylesheets -->
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="../assets/css/database.css">
    <link rel="stylesheet" href="../assets/css/tailwind.min.css">
    <!-- Favicon for all browsers -->
    <link rel="icon" href="../images/favicons/favicon.ico" type="image/x-icon">
    <!-- Apple Touch Icons (for iOS home screen bookmarks) -->
    <link rel="apple-touch-icon" sizes="57x57" href="../images/apple/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../images/apple/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../images/apple/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../images/apple/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="../images/apple/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="../images/apple/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="../images/apple/apple-icon-180x180.png">
    <!-- Favicons for different devices -->
    <link rel="icon" type="image/png" sizes="192x192" href="../images/android/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../images/favicons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="../images/favicons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../images/favicons/favicon-16x16.png">
    <!-- Web Manifest -->
    <link rel="manifest" href="../site-data/site.manifest">
    <!-- Windows-specific tiles (for pinned sites in Windows Start menu) -->
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="../images/microsoft/ms-icon-144x144.png">
    <!-- Defines the color of the browser UI elements -->
    <meta name="theme-color" content="#ffffff">
    <!-- Open Graph Meta Tags (for social media sharing, mainly Facebook) -->
    <meta property="og:title" content="CDA Project - Database">
    <meta property="og:description" content="Access the extensive database of compromised Discord accounts, malicious URLs, and attack vectors. This page allows users to search, filter, and analyze data with advanced tools, providing detailed insights into threat patterns and risk assessments.">
    <meta property="og:image" content="https://raw.githubusercontent.com/ThatSINEWAVE/CDA-Project/refs/heads/main/docs/images/social-share/CDA-Project-Database.png">
    <meta property="og:url" content="https://thatsinewave.github.io/CDA-Project">
    <meta property="og:type" content="website">
    <!-- Twitter Card Meta Tags (for better sharing on Twitter) -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="CDA Project - Database">
    <meta name="twitter:description" content="Access the extensive database of compromised Discord accounts, malicious URLs, and attack vectors. This page allows users to search, filter, and analyze data with advanced tools, providing detailed insights into threat patterns and risk assessments.">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/ThatSINEWAVE/CDA-Project/refs/heads/main/docs/images/social-share/CDA-Project-Database.png">
  </head>
  <body class="bg-gray-100 min-h-screen texture">
  <!-- Sidebar -->
  <div id="sidebar" class="sidebar bg-indigo-700">
    <div class="sidebar-header">
      <button id="closeSidebar" class="close-sidebar bg-indigo-700">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
    <nav class="sidebar-nav bg-indigo-700">
      <ul>
        <li>
          <a href="/CDA-Project/index.html" class="sidebar-link hover:bg-indigo-600">Home</a>
        </li>
        <li>
          <a href="/CDA-Project/pages/dashboard.html" class="sidebar-link hover:bg-indigo-600">Dashboard</a>
        </li>
        <li>
          <a href="/CDA-Project/pages/status.html" class="sidebar-link hover:bg-indigo-600">System Status</a>
        </li>
        <li>
          <a href="/CDA-Project/pages/database.html" class="sidebar-link hover:bg-indigo-600">Database</a>
        </li>
        <li>
          <a href="/CDA-Project/pages/info.html" class="sidebar-link hover:bg-indigo-600">Info Center</a>
        </li>
        <li>
          <a href="/CDA-Project/pages/threat-map.html" class="sidebar-link hover:bg-indigo-600">Threat Map</a>
        </li>
        <li>
          <a href="/CDA-Project/pages/intelligence.html" class="sidebar-link hover:bg-indigo-600">Intel Reports</a>
        </li>
        <li>
          <a href="/CDA-Project/pages/faq.html" class="sidebar-link hover:bg-indigo-600">Frequent Questions</a>
        </li>
        <li>
          <a href="#" class="sidebar-link hover:bg-indigo-600">Resources (COMING SOON)</a>
        </li>
        <li>
          <a href="https://github.com/ThatSINEWAVE/CDA-Project" class="sidebar-link hover:bg-indigo-600">Repository</a>
        </li>
        <li>
          <a href="https://discord.com/invite/2nHHHBWNDw" class="sidebar-link hover:bg-indigo-600">Discord</a>
        </li>
      </ul>
    </nav>
  </div>
  <!-- Sidebar Toggle Button -->
  <button id="sidebarToggle" class="sidebar-toggle bg-indigo-700">
    <svg xmlns="http://www.w3.org/2000/svg" class=" h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
    </svg>
  </button>
    <!-- Header -->
    <nav class="bg-indigo-700 text-white shadow-md">
      <div class="header-content">
        <div class="container mx-auto flex justify-between items-center">
          <!-- Header Title -->
          <div>
            <a href="/CDA-Project/index.html" class="block">
              <h1 class="text-2xl font-bold flex items-center"> CDA Project <span class="text-amber-400 text-xs ml-2 align-top">BETA</span>
              </h1>
              <p class="text-sm text-gray-200">Tracking Threats, Protecting Communities</p>
            </a>
          </div>
          <!-- Header Buttons -->
          <div class="flex items-center space-x-2">
            <!-- Theme Button -->
            <button id="darkModeToggle" class="p-2 rounded hover:bg-indigo-600" title="Theme Toggle">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
              </svg>
            </button>
            <!-- Info Button -->
            <button id="infoButton" class="p-2 rounded hover:bg-indigo-600" title="Info Page">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
              </svg>
            </button>
            <!-- FAQ Button -->
            <button id="faqButton" class="p-2 rounded hover:bg-indigo-600" title="FAQ Page">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd" />
              </svg>
            </button>
          </div>
        </div>
      </div>
    </nav>
    <!-- Announcement Bar -->
    <div id="announcement-bar" class="announcement-bar hidden">
      <div class="container mx-auto py-3 px-4">
        <div class="flex items-center justify-between">
          <!-- Announcement Message -->
          <div class="announcement-content">
            <p id="announcement-text" class="text-sm md:text-base font-medium"></p>
          </div>
          <!-- Close Announcement Button -->
          <button id="closeAnnouncement" class="ml-4 text-white opacity-70 hover:opacity-100 transition-opacity">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
              <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
            </svg>
          </button>
        </div>
      </div>
    </div>
    <!-- Breadcrumbs -->
    <div class="breadcrumb-container">
      <div class="container mx-auto px-4 py-2">
        <nav class="flex" aria-label="Breadcrumb">
          <ol class="inline-flex items-center space-x-2">
            <!-- Home Breadcrumb -->
            <li class="inline-flex items-center">
              <a href="/CDA-Project/index.html" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-indigo-600">
                <svg class="w-4 h-4 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path>
                </svg> Home </a>
            </li>
            <!-- Database Breadcrumb -->
            <li class="inline-flex items-center">
              <span class="text-gray-400 mx-2">></span>
              <span class="text-sm font-medium text-gray-500">Database</span>
            </li>
          </ol>
        </nav>
      </div>
    </div>
    <!-- Main Content -->
    <div class="container mx-auto px-4 py-8">
      <!-- Advanced Filters Section -->
      <div class="database-filters bg-white p-6 rounded-lg shadow-lg mb-6">
        <h2 class="text-2xl font-bold text-indigo-700 mb-6">Advanced Filters</h2>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          <!-- Search by Username -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Search by Username</label>
            <input id="usernameFilter" type="text" class="w-full border border-gray-300 rounded p-2" placeholder="Enter username">
          </div>
          <!-- Filter by Attack Method -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Attack Method</label>
            <select id="attackMethodFilter" class="w-full border border-gray-300 rounded p-2">
              <option value="">All Methods</option>
            </select>
          </div>
          <!-- Filter by Attack Surface -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Attack Surface</label>
            <select id="attackSurfaceFilter" class="w-full border border-gray-300 rounded p-2">
              <option value="">All Surfaces</option>
            </select>
          </div>
          <!-- Filter by URL Status -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by URL Status</label>
            <select id="urlStatusFilter" class="w-full border border-gray-300 rounded p-2">
              <option value="">All Statuses</option>
              <option value="ACTIVE">Active</option>
              <option value="INACTIVE">Inactive</option>
              <option value="UNKNOWN">Unknown</option>
            </select>
          </div>
          <!-- Filter by Date Range -->
          <div class="col-span-1 md:col-span-2">
            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Date Range</label>
            <div class="flex gap-2">
              <input id="dateFrom" type="date" class="w-1/2 border border-gray-300 rounded p-2">
              <input id="dateTo" type="date" class="w-1/2 border border-gray-300 rounded p-2">
            </div>
          </div>
          <!-- Filter by Account Status -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Account Status</label>
            <select id="accountStatusFilter" class="w-full border border-gray-300 rounded p-2">
              <option value="">All Statuses</option>
              <option value="COMPROMISED">Compromised</option>
              <option value="DELETED">Deleted</option>
            </select>
          </div>
          <!-- Filter by Region -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Region</label>
            <select id="regionFilter" class="w-full border border-gray-300 rounded p-2">
              <option value="">All Regions</option>
            </select>
          </div>
          <!-- Filter by Non-ASCII Username -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Filter by Non-ASCII Username</label>
            <select id="nonAsciiFilter" class="w-full border border-gray-300 rounded p-2">
              <option value="">All</option>
              <option value="true">Non-ASCII</option>
              <option value="false">ASCII Only</option>
            </select>
          </div>
        </div>
        <div class="mt-6 flex justify-end">
          <button id="resetFilters" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">Reset Filters</button>
          <button id="applyFilters" class="bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded ml-2">Apply Filters</button>
        </div>
      </div>
      <!-- Data Table -->
      <div class="database-table bg-white p-6 rounded-lg shadow-lg">
        <h2 class="text-2xl font-bold text-indigo-700 mb-6">Database Entries</h2>
        <div class="table-container">
          <table id="databaseTable" class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
              <tr>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Case #</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Found On</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Username</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Account Status</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Behaviour</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Attack Method</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Attack Surface</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">URL Status</th>
                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Region</th>
              </tr>
            </thead>
            <tbody id="tableBody">
              <!-- Table rows will be inserted here -->
            </tbody>
          </table>
        </div>
        <div class="mt-4 flex justify-between items-center">
          <span id="tableInfo" class="text-sm text-gray-600">Showing 0 of 0 entries</span>
          <div class="pagination-controls">
            <button id="prevPage" class="prev-page">Previous</button>
            <button id="nextPage" class="next-page">Next</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Footer -->
    <footer class="bg-indigo-700 text-white p-4 shadow-lg mt-8">
      <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
        <!-- Footer Text -->
        <div class="mb-4 md:mb-0">
          <p>Created by ThatSINEWAVE - Cybersight Security</p>
          <p>Â© 2025 CDA - Compromised Discord Accounts Project</p>
        </div>
        <!-- Footer Buttons -->
        <div class="flex space-x-4">
          <!-- Github Repo Button -->
          <a href="https://github.com/ThatSINEWAVE/CDA-Project" class="hover:text-indigo-200 transition-colors" title="GitHub Repository">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z" />
            </svg>
          </a>
          <!-- Ko-Fi Button -->
          <a href="https://ko-fi.com/thatsinewave" class="hover:text-indigo-200 transition-colors" title="Support Me">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
            </svg>
          </a>
          <!-- Discord Button -->
          <a href="https://discord.gg/2nHHHBWNDw" class="hover:text-indigo-200 transition-colors" title="Discord Server">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M20.317 4.3698a19.7913 19.7913 0 00-4.8851-1.5152.0741.0741 0 00-.0785.0371c-.211.3753-.4447.8648-.6083 1.2495-1.8447-.2762-3.68-.2762-5.4868 0-.1636-.3847-.4058-.8742-.6177-1.2495a.077.077 0 00-.0785-.037 19.7363 19.7363 0 00-4.8852 1.515.0699.0699 0 00-.0321.0277C.5334 9.0458-.319 13.5799.0992 18.0578a.0824.0824 0 00.0312.0561c2.0528 1.5076 4.0413 2.4228 5.9929 3.0294a.0777.0777 0 00.0842-.0276c.4616-.6304.8731-1.2952 1.226-1.9942a.076.076 0 00-.0416-.1057c-.6528-.2476-1.2743-.5495-1.8722-.8923a.077.077 0 01-.0076-.1277c.1258-.0943.2517-.1923.3718-.2914a.0743.0743 0 01.0776-.0105c3.9278 1.7933 8.18 1.7933 12.0614 0a.0739.0739 0 01.0785.0095c.1202.099.246.1981.3728.2924a.077.077 0 01-.0066.1276 12.2986 12.2986 0 01-1.873.8914.0766.0766 0 00-.0407.1067c.3604.698.7719 1.3628 1.225 1.9932a.076.076 0 00.0842.0286c1.961-.6067 3.9495-1.5219 6.0023-3.0294a.077.077 0 00.0313-.0552c.5004-5.177-.8382-9.6739-3.5485-13.6604a.061.061 0 00-.0312-.0286z" />
            </svg>
          </a>
          <!-- Status Button -->
          <a href="/CDA-Project/status.html" class="hover:text-indigo-200 transition-colors" title="Status Page">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
              <path d="M12 1L3 5v6c0 5.5 3.8 10.7 9 12 5.2-1.3 9-6.5 9-12V5l-9-4zm0 2.2l7 3.1v5.7c0 4.4-2.8 8.8-7 10-4.2-1.2-7-5.6-7-10V6.3l7-3.1zm-1 5.3v4h2V8.5h-2zm0 6v2h2v-2h-2z"/>
            </svg>
          </a>
        </div>
      </div>
    </footer>
    <!-- Scripts -->
    <script src="../assets/js/script.js" type="module"></script>
    <!-- Local Chart.js Copy -->
    <script src="../assets/js/chart.min.js"></script>
    <!-- Local Day.js Copy -->
    <script src="../assets/js/dayjs.min.js"></script>
    <!-- Announcement Script -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        fetch("https://raw.githubusercontent.com/ThatSINEWAVE/CDA-Project/refs/heads/main/data/Announcement.json").then(response => response.json()).then(data => {
          const announcementDate = data.date; // Example: "2025-03-16 13:50 GMT+2"
          const announcementText = data.text;
          // Format the version string
          const dateParts = announcementDate.match(/\d+/g);
          const CURRENT_ANNOUNCEMENT_VERSION = `${dateParts[0]}-${dateParts[1]}-${dateParts[2]}-${dateParts[3]}-${dateParts[4]}`;
          document.getElementById('announcement-text').textContent = `ðŸ”” Update - ${announcementDate}: ${announcementText}`;
          // Check if announcement was previously closed AND if it's the same version
          const announcementClosed = localStorage.getItem('announcementClosed') === 'true';
          const lastClosedVersion = localStorage.getItem('lastClosedAnnouncementVersion');
          if (announcementClosed && lastClosedVersion === CURRENT_ANNOUNCEMENT_VERSION) {
            document.getElementById('announcement-bar').classList.add('hidden');
          } else {
            document.getElementById('announcement-bar').classList.remove('hidden');
          }
          // Close button logic
          document.getElementById('closeAnnouncement').addEventListener('click', function() {
            document.getElementById('announcement-bar').classList.add('hidden');
            localStorage.setItem('announcementClosed', 'true');
            localStorage.setItem('lastClosedAnnouncementVersion', CURRENT_ANNOUNCEMENT_VERSION);
          });
        }).catch(error => console.error("Error fetching announcement:", error));
      });
    </script>
    <!-- FAQ Button Script -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // FAQ Button handler
        const faqButton = document.getElementById('faqButton');
        if (faqButton) {
          faqButton.addEventListener('click', () => {
            window.location.href = 'faq.html';
          });
        }
      });
    </script>
    <!-- Database Page Script -->
    <script>
      // Initialize theme when the page loads
      document.addEventListener('DOMContentLoaded', () => {
          initializeTheme();
          fetchData();
      });

      // Dark mode toggle
      const darkModeToggle = document.getElementById('darkModeToggle');
      if (darkModeToggle) {
          darkModeToggle.addEventListener('click', toggleDarkMode);
      }

      // Info button functionality
      const infoButton = document.getElementById('infoButton');
      if (infoButton) {
          infoButton.addEventListener('click', () => {
              window.location.href = 'info.html';
          });
      }

      // Function to toggle dark mode
      function toggleDarkMode() {
          const isDarkMode = document.body.classList.contains('bg-gray-900');
          // Toggle classes
          document.body.classList.toggle('bg-gray-900');
          document.body.classList.toggle('text-white');
          const cards = document.querySelectorAll('.bg-white');
          cards.forEach(card => {
              card.classList.toggle('bg-gray-800');
              card.classList.toggle('text-white');
          });
          // Save state to localStorage
          localStorage.setItem('darkMode', isDarkMode ? 'disabled' : 'enabled');
      }

      // Function to initialize theme based on user preference
      function initializeTheme() {
          const isDarkMode = localStorage.getItem('darkMode') === 'enabled';
          if (isDarkMode) {
              document.body.classList.add('bg-gray-900', 'text-white');
              const cards = document.querySelectorAll('.bg-white');
              cards.forEach(card => {
                  card.classList.add('bg-gray-800', 'text-white');
              });
          }
      }

      // Fetch data from JSON file
      let accountsData = {};
      let filteredData = [];
      let currentPage = 1;
      const rowsPerPage = 10;

      async function fetchData() {
          try {
              const response = await fetch('https://raw.githubusercontent.com/ThatSINEWAVE/CDA-Project/refs/heads/main/data/Compromised-Discord-Accounts.json');
              if (!response.ok) throw new Error('Failed to fetch data');
              accountsData = await response.json();
              populateFilters(accountsData);
              filterData();
          } catch (error) {
              console.error('Error fetching data:', error);
          }
      }

      function populateFilters(data) {
          const attackMethods = new Set();
          const attackSurfaces = new Set();
          const regions = new Set();
          Object.values(data).forEach(account => {
              attackMethods.add(account.ATTACK_METHOD);
              attackSurfaces.add(account.ATTACK_SURFACE);
              regions.add(account.SUSPECTED_REGION_OF_ORIGIN);
          });
          populateDropdown('attackMethodFilter', attackMethods);
          populateDropdown('attackSurfaceFilter', attackSurfaces);
          populateDropdown('regionFilter', regions);
      }

      function populateDropdown(id, values) {
          const dropdown = document.getElementById(id);
          dropdown.innerHTML = '<option value="">All</option>';
          values.forEach(value => {
              const option = document.createElement('option');
              option.value = value;
              option.textContent = value;
              dropdown.appendChild(option);
          });
      }

      function filterData() {
          const usernameFilter = document.getElementById('usernameFilter').value.toLowerCase();
          const attackMethodFilter = document.getElementById('attackMethodFilter').value;
          const attackSurfaceFilter = document.getElementById('attackSurfaceFilter').value;
          const urlStatusFilter = document.getElementById('urlStatusFilter').value;
          const dateFrom = document.getElementById('dateFrom').value;
          const dateTo = document.getElementById('dateTo').value;
          const accountStatusFilter = document.getElementById('accountStatusFilter').value;
          const regionFilter = document.getElementById('regionFilter').value;
          const nonAsciiFilter = document.getElementById('nonAsciiFilter').value;
          filteredData = Object.values(accountsData).filter(account => {
              const foundDate = new Date(account.FOUND_ON);
              const matchesUsername = !usernameFilter || account.USERNAME.toLowerCase().includes(usernameFilter);
              const matchesAttackMethod = !attackMethodFilter || account.ATTACK_METHOD === attackMethodFilter;
              const matchesAttackSurface = !attackSurfaceFilter || account.ATTACK_SURFACE === attackSurfaceFilter;
              const matchesUrlStatus = !urlStatusFilter || account.FINAL_URL_STATUS === urlStatusFilter;
              const matchesDate = (!dateFrom || new Date(account.FOUND_ON) >= new Date(dateFrom)) && (!dateTo || new Date(account.FOUND_ON) <= new Date(dateTo));
              const matchesAccountStatus = !accountStatusFilter || account.ACCOUNT_STATUS === accountStatusFilter;
              const matchesRegion = !regionFilter || account.SUSPECTED_REGION_OF_ORIGIN === regionFilter;
              const matchesNonAscii = nonAsciiFilter === "" || (nonAsciiFilter === "true" && /[^\x00-\x7F]/.test(account.USERNAME)) || (nonAsciiFilter === "false" && !/[^\x00-\x7F]/.test(account.USERNAME));
              return matchesUsername && matchesAttackMethod && matchesAttackSurface && matchesUrlStatus && matchesDate && matchesAccountStatus && matchesRegion && matchesNonAscii;
          });
          currentPage = 1;
          updateTable();
      }

      function updateTable() {
          const tableBody = document.getElementById('tableBody');
          tableBody.innerHTML = '';
          const startIndex = (currentPage - 1) * rowsPerPage;
          const endIndex = startIndex + rowsPerPage;
          const pageData = filteredData.slice(startIndex, endIndex);
          pageData.forEach(account => {
              const row = document.createElement('tr');
              row.innerHTML = `
            <td class="px-6 py-4">${account.CASE_NUMBER}</td>
            <td class="px-6 py-4">${formatDate(account.FOUND_ON)}</td>
            <td class="px-6 py-4">${account.USERNAME}</td>
            <td class="px-6 py-4">${account.ACCOUNT_STATUS}</td>
            <td class="px-6 py-4">${account.BEHAVIOUR}</td>
            <td class="px-6 py-4">${account.ATTACK_METHOD}</td>
            <td class="px-6 py-4">${account.ATTACK_SURFACE}</td>
            <td class="px-6 py-4">${account.FINAL_URL_STATUS}</td>
            <td class="px-6 py-4">${account.SUSPECTED_REGION_OF_ORIGIN}</td>
          `;
              tableBody.appendChild(row);
          });
          document.getElementById('tableInfo').textContent = `Showing ${startIndex + 1}-${Math.min(endIndex, filteredData.length)} of ${filteredData.length} entries`;
          document.getElementById('prevPage').disabled = currentPage === 1;
          document.getElementById('nextPage').disabled = endIndex >= filteredData.length;
          document.querySelectorAll('.view-details').forEach(button => {
              button.addEventListener('click', () => {
                  const caseNumber = button.getAttribute('data-case');
                  showAccountDetails(caseNumber);
              });
          });
      }

      function formatDate(dateString) {
          const options = {
              year: 'numeric',
              month: 'short',
              day: 'numeric'
          };
          return new Date(dateString).toLocaleDateString(undefined, options);
      }

      function showAccountDetails(caseNumber) {
          const account = Object.values(accountsData).find(acc => acc.CASE_NUMBER === caseNumber);
          if (!account) return;
          const modal = document.getElementById('detailModal');
          const modalContent = document.getElementById('modalContent');
          modalContent.innerHTML = `
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <h3 class="font-medium text-lg mb-2">Account Information</h3>
              <p>
                <span class="font-medium">Case Number:</span> ${account.CASE_NUMBER}
              </p>
              <p>
                <span class="font-medium">Found On:</span> ${formatDate(account.FOUND_ON)}
              </p>
              <p>
                <span class="font-medium">Discord ID:</span> ${account.DISCORD_ID}
              </p>
              <p>
                <span class="font-medium">Username:</span> ${account.USERNAME}
              </p>
              <p>
                <span class="font-medium">Behaviour:</span> ${account.BEHAVIOUR}
              </p>
            </div>
            <div>
              <h3 class="font-medium text-lg mb-2">Attack Details</h3>
              <p>
                <span class="font-medium">Attack Method:</span> ${account.ATTACK_METHOD}
              </p>
              <p>
                <span class="font-medium">Attack Vector:</span> ${account.ATTACK_VECTOR}
              </p>
              <p>
                <span class="font-medium">Attack Goal:</span> ${account.ATTACK_GOAL}
              </p>
              <p>
                <span class="font-medium">Attack Surface:</span> ${account.ATTACK_SURFACE}
              </p>
              <p>
                <span class="font-medium">Suspected Origin:</span> ${account.SUSPECTED_REGION_OF_ORIGIN}
              </p>
            </div>
          </div>
          <div class="mt-4">
            <h3 class="font-medium text-lg mb-2">URLs</h3>
            <div class="overflow-x-auto">
              <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                  <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">URL Type</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">URL</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Domain</th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="px-6 py-4 whitespace-nowrap">Surface URL</td>
                    <td class="px-6 py-4 url-cell">
                      <a href="#" class="text-indigo-600 hover:text-indigo-900 break-all">${account.SURFACE_URL}</a>
                    </td>
                    <td class="px-6 py-4 domain-cell" title="${account.SURFACE_URL_DOMAIN}">${account.SURFACE_URL_DOMAIN}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${account.SURFACE_URL_STATUS === 'ACTIVE' ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'}">
                        ${account.SURFACE_URL_STATUS}
                      </span>
                    </td>
                  </tr>
                  <tr>
                    <td class="px-6 py-4 whitespace-nowrap">Final URL</td>
                    <td class="px-6 py-4 url-cell">
                      <a href="#" class="text-indigo-600 hover:text-indigo-900 break-all">${account.FINAL_URL}</a>
                    </td>
                    <td class="px-6 py-4 domain-cell" title="${account.FINAL_URL_DOMAIN}">${account.FINAL_URL_DOMAIN}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                      <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${account.FINAL_URL_STATUS === 'ACTIVE' ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'}">
                        ${account.FINAL_URL_STATUS}
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        `;
          modal.classList.remove('hidden');
      }

      document.getElementById('applyFilters').addEventListener('click', filterData);
      document.getElementById('resetFilters').addEventListener('click', () => {
          document.getElementById('usernameFilter').value = '';
          document.getElementById('attackMethodFilter').value = '';
          document.getElementById('attackSurfaceFilter').value = '';
          document.getElementById('urlStatusFilter').value = '';
          document.getElementById('dateFrom').value = '';
          document.getElementById('dateTo').value = '';
          document.getElementById('accountStatusFilter').value = '';
          document.getElementById('regionFilter').value = '';
          document.getElementById('nonAsciiFilter').value = '';
          filterData();
      });

      document.getElementById('prevPage').addEventListener('click', () => {
          if (currentPage > 1) {
              currentPage--;
              updateTable();
          }
      });

      document.getElementById('nextPage').addEventListener('click', () => {
          const maxPage = Math.ceil(filteredData.length / rowsPerPage);
          if (currentPage < maxPage) {
              currentPage++;
              updateTable();
          }
      });
    </script>
  </body>
</html>